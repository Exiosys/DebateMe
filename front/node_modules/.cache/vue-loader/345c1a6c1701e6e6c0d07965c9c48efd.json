{"remainingRequest":"/Users/brdnicolas/Desktop/DebateMe/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/brdnicolas/Desktop/DebateMe/front/src/components/admin/AddQuestion.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/brdnicolas/Desktop/DebateMe/front/src/components/admin/AddQuestion.vue","mtime":1597098079365},{"path":"/Users/brdnicolas/Desktop/DebateMe/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/brdnicolas/Desktop/DebateMe/front/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/brdnicolas/Desktop/DebateMe/front/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/brdnicolas/Desktop/DebateMe/front/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/brdnicolas/Desktop/DebateMe/front/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi8vIEB0cy1ub2NoZWNrCmltcG9ydCB7IENvbXBvbmVudCwgVnVlIH0gZnJvbSAndnVlLXByb3BlcnR5LWRlY29yYXRvcic7CmltcG9ydCBNZW51IGZyb20gIkAvY29tcG9uZW50cy9hZG1pbi9NZW51LnZ1ZSI7CmltcG9ydCBIZWFkZXIgZnJvbSAiQC9jb21wb25lbnRzL21pbmktY29tcG9uZW50cy9oZWFkZXIudnVlIjsKaW1wb3J0IG15QVBJIGZyb20gIkAvY29tcG9uZW50cy9teUFQSSI7CmltcG9ydCBTd2FsIGZyb20gJ3N3ZWV0YWxlcnQyL2Rpc3Qvc3dlZXRhbGVydDIuanMnCgpAQ29tcG9uZW50KHsKICAgIGNvbXBvbmVudHM6IHsKICAgICAgICBIZWFkZXIsCiAgICAgICAgTWVudQogICAgfSwKfSkKCmV4cG9ydCBkZWZhdWx0IGNsYXNzIEhlbGxvV29ybGQgZXh0ZW5kcyBWdWUgewoKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy5jaGVja0FkbWluKCk7CiAgICAgICAgdGhpcy5nZXRUaGVtZXMoKTsKICAgIH0KCiAgICB0aGVtZXM6IG9iamVjdDsKICAgIHNlbGVjdGVkVGhlbWU6IHN0cmluZzsKICAgIGNvbnN0cnVjdG9yKCkgewogICAgICAgICAgc3VwZXIoKTsKICAgICAgICAgIHRoaXMudGhlbWVzID0gW107CiAgICAgICAgICB0aGlzLnNlbGVjdGVkVGhlbWUgPSAibm9uZSIKICAgIH0KCiAgICBzZWxlY3RGaWxlKCk6IHZvaWQgewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmaWxlUXVlc3Rpb24iKS5jbGljaygpOwogICAgfQoKICAgIGFzeW5jIGdldFRoZW1lcygpOiBQcm9taXNlPHZvaWQ+IHsKICAgICAgICBsZXQgcmVwID0gbnVsbDsKICAgICAgICBhd2FpdCBteUFQSS5nZXQoInRoZW1lcy8iKQogICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIHJlcCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKHJlcCkgewogICAgICAgICAgICB0aGlzLnRoZW1lcyA9IHJlcDsKICAgICAgICAgICAgY29uc29sZS5sb2coIm9rIikKICAgICAgICAgICAgY29uc29sZS5sb2cocmVwKTsKICAgICAgICB9CiAgICB9CgogICAgYXN5bmMgbmV3UXVlc3Rpb24oKTogUHJvbWlzZTx2b2lkPiB7CiAgICAgICAgY29uc3QgdmFsdWVUaXRsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0aXRsZVF1ZXN0aW9uIikgYXMgSFRNTEVsZW1lbnQ7CiAgICAgICAgY29uc3QgdmFsdWVEb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZG9jUXVlc3Rpb24iKSBhcyBIVE1MRWxlbWVudDsKICAgICAgICBjb25zdCB2YWx1ZUltZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmaWxlUXVlc3Rpb24iKSBhcyBIVE1MRWxlbWVudDsKICAgICAgICBjb25zdCBkYXRhID0gbmV3IEZvcm1EYXRhKCk7CgogICAgICAgIGlmICh2YWx1ZUltZy5maWxlc1swXSkKICAgICAgICAgIGRhdGEuYXBwZW5kKCdpbWFnZScsIHZhbHVlSW1nLmZpbGVzWzBdKTsKCiAgICAgICAgaWYodmFsdWVUaXRsZSAmJiB2YWx1ZURvYykgewogICAgICAgICAgICBkYXRhLmFwcGVuZCgndGl0bGUnLCB2YWx1ZVRpdGxlLnZhbHVlKTsKICAgICAgICAgICAgZGF0YS5hcHBlbmQoJ2RvY3VtZW50YXRpb24nLCB2YWx1ZURvYy52YWx1ZSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IFRvYXN0ID0gU3dhbC5taXhpbih7CiAgICAgICAgICB0b2FzdDogdHJ1ZSwKICAgICAgICAgIHBvc2l0aW9uOiAndG9wLWVuZCcsCiAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UsCiAgICAgICAgfSk7CgogICAgICAgIGxldCByZXAgPSBudWxsOwogICAgICAgIGF3YWl0IG15QVBJLnBvc3QoInRoZW1lcy8iKyB0aGlzLnNlbGVjdGVkVGhlbWUgKyIvcXVlc3Rpb25zIiwgewogICAgICAgICAgZGF0YQogICAgICAgIH0pCiAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgcmVwID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgfSk7CiAgICAgICAgaWYgKHJlcCkgewogICAgICAgICAgICBhd2FpdCBUb2FzdC5maXJlKHsKICAgICAgICAgICAgICBpY29uOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgdGl0bGU6ICdMYSBxdWVzdGlvbiBhIGJpZW4gw6l0w6kgY3LDqcOpZScKICAgICAgICAgICAgfSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhd2FpdCBUb2FzdC5maXJlKHsKICAgICAgICAgICAgICBpY29uOiAnZXJyb3InLAogICAgICAgICAgICAgIHRpdGxlOiAiRXJyZXVyIGxvcnMgZGUgbGEgY3LDqWF0aW9uIGRlIGxhIHF1ZXN0aW9uLiIKICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICB9CgogICAgYXN5bmMgY2hlY2tBZG1pbigpOiBQcm9taXNlPHZvaWQ+IHsKICAgICAgICBsZXQgcmVwID0gbnVsbDsKICAgICAgICBhd2FpdCBteUFQSS5nZXQoInVzZXJzL21lL3Byb2ZpbGUiKQogICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7CiAgICAgICAgICAgIHJlcCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKHJlcCkgewogICAgICAgICAgICBpZiggIShyZXAgYXMgUmVjb3JkPHN0cmluZyxhbnk+KS5pc0FkbWluICkKICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy8nOwogICAgICAgIH0KICAgIH0KCgp9Cg=="},{"version":3,"sources":["AddQuestion.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAyBA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA","file":"AddQuestion.vue","sourceRoot":"src/components/admin","sourcesContent":["<template>\r\n    <div class=\"main\">\r\n        <Header/>\r\n        <div class=\"main2\">\r\n            <Menu/>\r\n            <div class=\"subMain\">\r\n                <h1>Ajouter une question</h1>\r\n                <div class=\"form\">\r\n                    <select class=\"themesInput\" v-model=\"selectedTheme\">\r\n                      <option disabled value=\"none\">Choisissez un thème</option>\r\n                      <option v-for=\"theme in this.themes\" v-bind:key=\"theme.name\" v-bind:value=\"theme.id\">{{theme.name}}</option>\r\n                    </select>\r\n                    <input id=\"fileQuestion\" style=\"display:none\" type=\"file\" />\r\n                    <button @click=\"selectFile\" class=\"chooseFile\">Choisir une image</button>\r\n                    <input id=\"titleQuestion\" class=\"textarea\" type=\"text\" placeholder=\"Titre\"/>\r\n                    <textarea id=\"docQuestion\" class=\"textarea2\" type=\"text\" placeholder=\"Documentation\"/>\r\n                    <button @click=\"newQuestion\" class=\"sendQuestion\">Poser la question</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\n    // @ts-nocheck\r\n    import { Component, Vue } from 'vue-property-decorator';\r\n    import Menu from \"@/components/admin/Menu.vue\";\r\n    import Header from \"@/components/mini-components/header.vue\";\r\n    import myAPI from \"@/components/myAPI\";\r\n    import Swal from 'sweetalert2/dist/sweetalert2.js'\r\n\r\n    @Component({\r\n        components: {\r\n            Header,\r\n            Menu\r\n        },\r\n    })\r\n\r\n    export default class HelloWorld extends Vue {\r\n\r\n        mounted() {\r\n            this.checkAdmin();\r\n            this.getThemes();\r\n        }\r\n\r\n        themes: object;\r\n        selectedTheme: string;\r\n        constructor() {\r\n              super();\r\n              this.themes = [];\r\n              this.selectedTheme = \"none\"\r\n        }\r\n\r\n        selectFile(): void {\r\n            document.getElementById(\"fileQuestion\").click();\r\n        }\r\n\r\n        async getThemes(): Promise<void> {\r\n            let rep = null;\r\n            await myAPI.get(\"themes/\")\r\n            .then(function(response) {\r\n                rep = response.data;\r\n            });\r\n            if (rep) {\r\n                this.themes = rep;\r\n                console.log(\"ok\")\r\n                console.log(rep);\r\n            }\r\n        }\r\n\r\n        async newQuestion(): Promise<void> {\r\n            const valueTitle = document.getElementById(\"titleQuestion\") as HTMLElement;\r\n            const valueDoc = document.getElementById(\"docQuestion\") as HTMLElement;\r\n            const valueImg = document.getElementById(\"fileQuestion\") as HTMLElement;\r\n            const data = new FormData();\r\n\r\n            if (valueImg.files[0])\r\n              data.append('image', valueImg.files[0]);\r\n\r\n            if(valueTitle && valueDoc) {\r\n                data.append('title', valueTitle.value);\r\n                data.append('documentation', valueDoc.value);\r\n            }\r\n            const Toast = Swal.mixin({\r\n              toast: true,\r\n              position: 'top-end',\r\n              showConfirmButton: false,\r\n            });\r\n\r\n            let rep = null;\r\n            await myAPI.post(\"themes/\"+ this.selectedTheme +\"/questions\", {\r\n              data\r\n            })\r\n                .then(function(response) {\r\n                  rep = response.data;\r\n                });\r\n            if (rep) {\r\n                await Toast.fire({\r\n                  icon: 'success',\r\n                  title: 'La question a bien été créée'\r\n                })\r\n            } else {\r\n                await Toast.fire({\r\n                  icon: 'error',\r\n                  title: \"Erreur lors de la création de la question.\"\r\n                })\r\n            }\r\n        }\r\n\r\n        async checkAdmin(): Promise<void> {\r\n            let rep = null;\r\n            await myAPI.get(\"users/me/profile\")\r\n            .then(function(response) {\r\n                rep = response.data;\r\n            });\r\n            if (rep) {\r\n                if( !(rep as Record<string,any>).isAdmin )\r\n                    window.location.href = '/';\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n    .main {\r\n        background:#f8f9fe;\r\n        max-height: 100%;\r\n    }\r\n    .main2 {\r\n        display:flex;\r\n        flex-direction: row;\r\n    }\r\n\r\n    .subMain {\r\n        padding:50px;\r\n        width:calc(100% - 220px);\r\n        max-height:calc(100vh - 50px);\r\n        overflow: scroll;\r\n    }\r\n    .main2 {\r\n        max-height:100%;\r\n        overflow:hidden;\r\n    }\r\n    .subMain > h1 {\r\n        color:#154a85;\r\n    }\r\n    .form {\r\n        display:flex;\r\n        flex-direction: column;\r\n    }\r\n    .sendQuestion {\r\n      transition:0.2s;\r\n      border-radius: 6px;\r\n      border: none;\r\n      width:320px;\r\n      height:50px;\r\n      background-color: #76E27E;\r\n      color: white;\r\n      padding: 18px 70px 18px 70px;\r\n      margin-top: 50px;\r\n      cursor:pointer;\r\n    }\r\n    .sendQuestion:hover {\r\n      transition:0.2s;\r\n      background:#6BCE73;\r\n    }\r\n    .themesInput {\r\n      margin-top: 50px;\r\n      border : 1px solid #efefef;\r\n      padding: 10px;\r\n      width: 200px;\r\n      border-radius: 5px;\r\n      outline:none;\r\n    }\r\n    .chooseFile {\r\n        transition:0.2s;\r\n        border-radius: 6px;\r\n        border: none;\r\n        width:200px;\r\n        background-color: #1965FF;\r\n        color: white;\r\n        padding: 12px 30px 12px 30px;\r\n        margin-top:15px;\r\n        cursor:pointer;\r\n    }\r\n    .chooseFile:hover {\r\n        transition:0.2s;\r\n        background:#6b94ff;\r\n    }\r\n    .textarea {\r\n        transition:0.2s;\r\n        border : 1px solid #efefef;\r\n        padding: 15px;\r\n        width: 300px;\r\n        margin-top: 15px;\r\n        border-radius: 5px;\r\n        outline:none;\r\n    }\r\n    .textarea2 {\r\n      transition:0.2s;\r\n      border : 1px solid #efefef;\r\n      padding: 15px;\r\n      min-width: 900px;\r\n      max-width: 1300px;\r\n      min-height:250px;\r\n      max-height:500px;\r\n      margin-top: 15px;\r\n      border-radius: 5px;\r\n      outline:none;\r\n    }\r\n</style>\r\n"]}]}
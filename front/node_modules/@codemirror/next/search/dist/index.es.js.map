{"version":3,"file":"index.es.js","sources":["../src/cursor.ts","../src/search.ts"],"sourcesContent":["import {Text, TextIterator, isExtendingChar} from \"../../text\"\n\nconst basicNormalize: (string: string) => string = String.prototype.normalize ? x => x.normalize(\"NFKD\") : x => x\n\n/// A search cursor provides an iterator over text matches in a\n/// document.\nexport class SearchCursor implements Iterator<{from: number, to: number}>{\n  private iter: TextIterator\n  /// The current match (only holds a meaningful value after\n  /// [`next`](#search.SearchCursor.next) has been called and when\n  /// `done` is true).\n  value = {from: 0, to: 0}\n  /// Whether the end of the iterated region has been reached.\n  done = false\n  private matches: number[] = []\n  private buffer = \"\"\n  private bufferPos = 0\n  private bufferStart: number\n  private normalize: (string: string) => string\n  private query: string\n\n  /// Create a text cursor. The query is the search string, `from` to\n  /// `to` provides the region to search.\n  ///\n  /// When `normalize` is given, it will be called, on both the query\n  /// string and the content it is matched against, before comparing.\n  /// You can, for example, create a case-insensitive search by\n  /// passing `s => s.toLowerCase()`.\n  ///\n  /// Text is always normalized with\n  /// [`.normalize(\"NFKD\")`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/normalize)\n  /// (when supported).\n  constructor(readonly text: Text, query: string,\n              from: number = 0, to: number = text.length,\n              normalize?: (string: string) => string) {\n    this.iter = text.iterRange(from, to)\n    this.bufferStart = from\n    this.normalize = normalize ? x => normalize(basicNormalize(x)) : basicNormalize\n    this.query = this.normalize(query)\n  }\n\n  private peek() {\n    if (this.bufferPos == this.buffer.length) {\n      this.bufferStart += this.buffer.length\n      this.iter.next()\n      if (this.iter.done) return -1\n      this.bufferPos = 0\n      this.buffer = this.iter.value\n    }\n    return this.buffer.charCodeAt(this.bufferPos)\n  }\n\n  /// Look for the next match. Updates the iterator's\n  /// [`value`](#search.SearchCursor.value) and\n  /// [`done`](#search.SearchCursor.done) properties. Should be called\n  /// at least once before using the cursor.\n  next() {\n    for (;;) {\n      let next = this.peek()\n      if (next < 0) {\n        this.done = true\n        return this\n      }\n      let str = String.fromCharCode(next), start = this.bufferStart + this.bufferPos\n      this.bufferPos++\n      for (;;) {\n        let peek = this.peek()\n        if (peek < 0 || !isExtendingChar(peek)) break\n        this.bufferPos++\n        str += String.fromCharCode(peek)\n      }\n      let norm = this.normalize(str)\n      for (let i = 0, pos = start;; i++) {\n        let code = norm.charCodeAt(i)\n        let match = this.match(code, pos)\n        if (match) {\n          this.value = match!\n          return this\n        }\n        if (i == norm.length - 1) break\n        if (pos == start && i < str.length && str.charCodeAt(i) == code) pos++\n      }\n    }\n  }\n\n  private match(code: number, pos: number) {\n    let match: null | {from: number, to: number} = null\n    for (let i = 0; i < this.matches.length; i += 2) {\n      let index = this.matches[i], keep = false\n      if (this.query.charCodeAt(index) == code) {\n        if (index == this.query.length - 1) {\n          match = {from: this.matches[i + 1], to: pos + 1}\n        } else {\n          this.matches[i]++\n          keep = true\n        }\n      }\n      if (!keep) {\n        this.matches.splice(i, 2)\n        i -= 2\n      }\n    }\n    if (this.query.charCodeAt(0) == code) {\n      if (this.query.length == 1)\n        match = {from: pos, to: pos + 1}\n      else\n        this.matches.push(1, pos)\n    }\n    return match\n  }\n}\n","import {EditorView, ViewPlugin, ViewUpdate, Command, Decoration, DecorationSet, themeClass} from \"../../view\"\nimport {StateField, Facet, Annotation, EditorSelection, SelectionRange, Extension} from \"../../state\"\nimport {panels, Panel, showPanel} from \"../../panel\"\nimport {Keymap, NormalizedKeymap, keymap} from \"../../keymap\"\nimport {Text, isWordChar} from \"../../text\"\nimport {RangeSetBuilder} from \"../../rangeset\"\nimport {SearchCursor} from \"./cursor\"\nexport {SearchCursor}\n\nclass Query {\n  constructor(readonly search: string,\n              readonly replace: string,\n              readonly caseInsensitive: boolean) {}\n\n  eq(other: Query) {\n    return this.search == other.search && this.replace == other.replace && this.caseInsensitive == other.caseInsensitive\n  }\n\n  cursor(doc: Text, from = 0, to = doc.length) {\n    return new SearchCursor(doc, this.search, from, to, this.caseInsensitive ? x => x.toLowerCase() : undefined)\n  }\n\n  get valid() { return !!this.search }\n}\n\nconst searchAnnotation = Annotation.define<{query?: Query, panel?: boolean}>()\n\nconst searchState: StateField<SearchState> = StateField.define<SearchState>({\n  create() {\n    return new SearchState(new Query(\"\", \"\", false), [])\n  },\n  update(search, tr) {\n    let ann = tr.annotation(searchAnnotation)\n    return ann ? new SearchState(ann.query || search.query,\n                                 ann.panel == null ? search.panel :\n                                 ann.panel ? [createSearchPanel] : []) : search\n  }\n}).provideN(showPanel, s => s.panel)\n\nclass SearchState {\n  constructor(readonly query: Query, readonly panel: readonly ((view: EditorView) => Panel)[]) {}\n}\n\nconst matchMark = Decoration.mark({class: themeClass(\"searchmatch\")}),\n      selectedMatchMark = Decoration.mark({class: themeClass(\"searchmatch.selected\")})\n\nconst searchHighlighter = ViewPlugin.fromClass(class {\n  decorations: DecorationSet\n\n  constructor(readonly view: EditorView) {\n    this.decorations = this.highlight(view.state.field(searchState).query)\n  }\n\n  update(update: ViewUpdate) {\n    let state = update.state.field(searchState)\n    if (state != update.prevState.field(searchState) || update.docChanged || update.selectionSet)\n      this.decorations = this.highlight(state.query)\n  }\n\n  highlight(query: Query) {\n    let state = this.view.state, viewport = this.view.viewport\n    let cursor = query.cursor(state.doc, Math.max(0, viewport.from - query.search.length),\n                              Math.min(viewport.to + query.search.length, state.doc.length))\n    let builder = new RangeSetBuilder<Decoration>()\n    while (!cursor.next().done) {\n      let {from, to} = cursor.value\n      let selected = state.selection.ranges.some(r => r.from == from && r.to == to)\n      builder.add(from, to, selected ? selectedMatchMark : matchMark)\n    }\n    return builder.finish()\n  }\n}).decorations()\n\n/// The configuration options passed to [`search`](#search.search).\nexport interface SearchConfig {\n  /// A keymap with search-related bindings that should be enabled in\n  /// the editor. You can pass\n  /// [`defaultSearchKeymap`](#search.defaultSearchKeymap) here.\n  ///\n  /// Configuring bindings like this differs from just passing the\n  /// keymap as a separate extension in that the bindings in this\n  /// keymap are also available when the search panel is focused.\n  keymap?: Keymap\n\n  /// Additional key bindings to enable only in the search panel.\n  panelKeymap?: Keymap\n}\n\nconst panelKeymap = Facet.define<Keymap, NormalizedKeymap<Command>>({\n  combine(keymaps) {\n    let result = Object.create(null)\n    for (let map of keymaps) for (let prop of Object.keys(map)) result[prop] = map[prop]\n    return new NormalizedKeymap(result)\n  }\n})\n\n/// Create an extension that enables search/replace functionality.\n/// This needs to be enabled for any of the search-related commands to\n/// work.\nexport const search = function(config: SearchConfig): Extension {\n  // FIXME make multiple instances of this combine, somehow\n  let keys = Object.create(null), panelKeys = Object.create(null)\n  if (config.keymap) for (let key of Object.keys(config.keymap)) {\n    panelKeys[key] = keys[key] = config.keymap[key]\n  }\n  if (config.panelKeymap) for (let key of Object.keys(config.panelKeymap)) {\n    panelKeys[key] = config.panelKeymap[key]\n  }\n  return [\n    searchState,\n    keymap(keys),\n    panelKeymap.of(panelKeys),\n    searchHighlighter,\n    panels(),\n    baseTheme\n  ]\n}\n\nfunction beforeCommand(view: EditorView): boolean | SearchState {\n  let state = view.state.field(searchState)\n  if (!state) return false\n  if (!state.query.valid) {\n    openSearchPanel(view)\n    return true\n  }\n  return state\n}\n\nfunction findNextMatch(doc: Text, from: number, query: Query) {\n  let cursor = query.cursor(doc, from).next()\n  if (cursor.done) {\n    cursor = query.cursor(doc, 0, from + query.search.length - 1).next()\n    if (cursor.done) return null\n  }\n  return cursor.value\n}\n\n/// Open the search panel if it isn't already open, and move the\n/// selection to the first match after the current primary selection.\n/// Will wrap around to the start of the document when it reaches the\n/// end.\nexport const findNext: Command = view => {\n  let state = beforeCommand(view)\n  if (typeof state == \"boolean\") return state\n  let {from, to} = view.state.selection.primary\n  let next = findNextMatch(view.state.doc, view.state.selection.primary.from + 1, state.query)\n  if (!next || next.from == from && next.to == to) return false\n  view.dispatch(view.state.t().setSelection(EditorSelection.single(next.from, next.to)).scrollIntoView())\n  maybeAnnounceMatch(view)\n  return true\n}\n\nconst FindPrevChunkSize = 10000\n\n// Searching in reverse is, rather than implementing inverted search\n// cursor, done by scanning chunk after chunk forward.\nfunction findPrevInRange(query: Query, doc: Text, from: number, to: number) {\n  for (let pos = to;;) {\n    let start = Math.max(from, pos - FindPrevChunkSize - query.search.length)\n    let cursor = query.cursor(doc, start, pos), range: {from: number, to: number} | null = null\n    while (!cursor.next().done) range = cursor.value\n    if (range) return range\n    if (start == from) return null\n    pos -= FindPrevChunkSize\n  }\n}\n\n/// Move the selection to the previous instance of the search query,\n/// before the current primary selection. Will wrap past the start\n/// of the document to start searching at the end again.\nexport const findPrevious: Command = view => {\n  let plugin = beforeCommand(view)\n  if (typeof plugin == \"boolean\") return plugin\n  let {state} = view, {query} = plugin\n  let range = findPrevInRange(query, state.doc, 0, state.selection.primary.to - 1) ||\n    findPrevInRange(query, state.doc, state.selection.primary.from + 1, state.doc.length)\n  if (!range) return false\n  view.dispatch(state.t().setSelection(EditorSelection.single(range.from, range.to)).scrollIntoView())\n  maybeAnnounceMatch(view)\n  return true\n}\n\n/// Select all instances of the search query.\nexport const selectMatches: Command = view => {\n  let plugin = beforeCommand(view)\n  if (typeof plugin == \"boolean\") return plugin\n  let cursor = plugin.query.cursor(view.state.doc), ranges: SelectionRange[] = []\n  while (!cursor.next().done) ranges.push(new SelectionRange(cursor.value.from, cursor.value.to))\n  if (!ranges.length) return false\n  view.dispatch(view.state.t().setSelection(EditorSelection.create(ranges)))\n  return true\n}\n\n/// Replace the current match of the search query.\nexport const replaceNext: Command = view => {\n  let plugin = beforeCommand(view)\n  if (typeof plugin == \"boolean\") return plugin\n\n  let next = findNextMatch(view.state.doc, view.state.selection.primary.from, plugin.query)\n  if (!next) return false\n  let {from, to} = view.state.selection.primary, tr = view.state.t()\n  if (next.from == from && next.to == to) {\n    tr.replace(next.from, next.to, plugin.query.replace)\n    next = findNextMatch(tr.doc, tr.changes.mapPos(next.to), plugin.query)\n  }\n  if (next) tr.setSelection(EditorSelection.single(next.from, next.to)).scrollIntoView()\n  view.dispatch(tr)\n  if (next) maybeAnnounceMatch(view)\n  return true\n}\n\n/// Replace all instances of the search query with the given\n/// replacement.\nexport const replaceAll: Command = view => {\n  let plugin = beforeCommand(view)\n  if (typeof plugin == \"boolean\") return plugin\n  let cursor = plugin.query.cursor(view.state.doc), tr = view.state.t()\n  while (!cursor.next().done) {\n    let {from, to} = cursor.value\n    tr.replace(tr.changes.mapPos(from, 1), tr.changes.mapPos(to, -1), plugin.query.replace)\n  }\n  if (!tr.docChanged) return false\n  view.dispatch(tr)\n  return true\n}\n\nfunction createSearchPanel(view: EditorView) {\n  let {query} = view.state.field(searchState)\n  return {\n    dom: buildPanel({\n      view,\n      keymap: view.state.facet(panelKeymap),\n      query,\n      updateQuery(q: Query) {\n        if (!query.eq(q)) {\n          query = q\n          view.dispatch(view.state.t().annotate(searchAnnotation, {query}))\n        }\n      }\n    }),\n    mount() {\n      ;(this.dom.querySelector(\"[name=search]\") as HTMLInputElement).select()\n    },\n    pos: 80,\n    style: \"search\"\n  }\n}\n\n/// Make sure the search panel is open and focused.\nexport const openSearchPanel: Command = view => {\n  let state = view.state.field(searchState)!\n  if (!state) return false\n  if (!state.panel.length)\n    view.dispatch(view.state.t().annotate(searchAnnotation, {panel: true}))\n  return true\n}\n\n/// Default search-related bindings.\n///\n///  * Mod-f: [`openSearchPanel`](#search.openSearchPanel)\n///  * F3: [`findNext`](#search.findNext)\n///  * Shift-F3: [`findPrevious`](#search.findPrevious)\nexport const defaultSearchKeymap = {\n  \"Mod-f\": openSearchPanel,\n  \"F3\": findNext,\n  \"Shift-F3\": findPrevious\n}\n\n/// Close the search panel.\nexport const closeSearchPanel: Command = view => {\n  let state = view.state.field(searchState)\n  if (!state || !state.panel.length) return false\n  let panel = view.dom.querySelector(\".cm-panel-search\")\n  if (panel && panel.contains(view.root.activeElement)) view.focus()\n  view.dispatch(view.state.t().annotate(searchAnnotation, {panel: false}))\n  return true\n}\n\nfunction elt(name: string, props: null | {[prop: string]: any} = null, children: (Node | string)[] = []) {\n  let e = document.createElement(name)\n  if (props) for (let prop in props) {\n    let value = props[prop]\n    if (typeof value == \"string\") e.setAttribute(prop, value)\n    else (e as any)[prop] = value\n  }\n  for (let child of children)\n    e.appendChild(typeof child == \"string\" ? document.createTextNode(child) : child)\n  return e\n}\n\n// FIXME sync when search state changes independently\nfunction buildPanel(conf: {\n  keymap: NormalizedKeymap<Command>,\n  view: EditorView,\n  query: Query,\n  updateQuery: (query: Query) => void\n}) {\n  function p(phrase: string) { return conf.view.phrase(phrase) }\n  let searchField = elt(\"input\", {\n    value: conf.query.search,\n    placeholder: p(\"Find\"),\n    \"aria-label\": p(\"Find\"),\n    name: \"search\",\n    onchange: update,\n    onkeyup: update\n  }) as HTMLInputElement\n  let replaceField = elt(\"input\", {\n    value: conf.query.replace,\n    placeholder: p(\"Replace\"),\n    \"aria-label\": p(\"Replace\"),\n    name: \"replace\",\n    onchange: update,\n    onkeyup: update\n  }) as HTMLInputElement\n  let caseField = elt(\"input\", {\n    type: \"checkbox\",\n    name: \"case\",\n    checked: !conf.query.caseInsensitive,\n    onchange: update\n  }) as HTMLInputElement\n  function update() {\n    conf.updateQuery(new Query(searchField.value, replaceField.value, !caseField.checked))\n  }\n  function keydown(e: KeyboardEvent) {\n    let mapped = conf.keymap.get(e)\n    if (mapped && mapped(conf.view)) {\n      e.preventDefault()\n    } else if (e.keyCode == 27) {\n      e.preventDefault()\n      closeSearchPanel(conf.view)\n    } else if (e.keyCode == 13 && e.target == searchField) {\n      e.preventDefault()\n      ;(e.shiftKey ? findPrevious : findNext)(conf.view)\n    } else if (e.keyCode == 13 && e.target == replaceField) {\n      e.preventDefault()\n      replaceNext(conf.view)\n    }\n  }\n  let panel = elt(\"div\", {onkeydown: keydown}, [\n    searchField,\n    elt(\"button\", {name: \"next\", onclick: () => findNext(conf.view)}, [p(\"next\")]),\n    elt(\"button\", {name: \"prev\", onclick: () => findPrevious(conf.view)}, [p(\"previous\")]),\n    elt(\"button\", {name: \"select\", onclick: () => selectMatches(conf.view)}, [p(\"all\")]),\n    elt(\"label\", null, [caseField, \"match case\"]),\n    elt(\"br\"),\n    replaceField,\n    elt(\"button\", {name: \"replace\", onclick: () => replaceNext(conf.view)}, [p(\"replace\")]),\n    elt(\"button\", {name: \"replaceAll\", onclick: () => replaceAll(conf.view)}, [p(\"replace all\")]),\n    elt(\"button\", {name: \"close\", onclick: () => closeSearchPanel(conf.view), \"aria-label\": p(\"close\")}, [\"×\"]),\n    elt(\"div\", {style: \"position: absolute; top: -10000px\", \"aria-live\": \"polite\"})\n  ])\n  return panel\n}\n\nconst AnnounceMargin = 30\n\n// FIXME this is a kludge\nfunction maybeAnnounceMatch(view: EditorView) {\n  let {doc} = view.state, {from, to} = view.state.selection.primary\n  let lineStart = doc.lineAt(from).start, lineEnd = doc.lineAt(to).end\n  let start = Math.max(lineStart, from - AnnounceMargin), end = Math.min(lineEnd, to + AnnounceMargin)\n  let text = doc.slice(start, end)\n  if (start != lineStart) {\n    for (let i = 0; i < AnnounceMargin; i++) if (isWordChar(text[i + 1]) && !isWordChar(text[i])) {\n      text = text.slice(i)\n      break\n    }\n  }\n  if (end != lineEnd) {\n    for (let i = text.length - 1; i > text.length - AnnounceMargin; i--) if (isWordChar(text[i - 1]) && !isWordChar(text[i])) {\n      text = text.slice(0, i)\n      break\n    }\n  }\n\n  let state = view.state.field(searchState)\n  let panel = state.panel.length && view.dom.querySelector(\".cm-panel-search\")\n  if (!panel || !panel.contains(view.root.activeElement)) return\n  let live = panel.querySelector(\"div[aria-live]\")!\n  live.textContent = view.phrase(\"current match\") + \". \" + text\n}\n\nconst baseTheme = EditorView.baseTheme({\n  \"panel.search\": {\n    padding: \"2px 6px 4px\",\n    position: \"relative\",\n    \"& [name=close]\": {\n      position: \"absolute\",\n      top: \"0\",\n      right: \"4px\",\n      background: \"inherit\",\n      border: \"none\",\n      font: \"inherit\",\n      padding: 0,\n      margin: 0\n    },\n    \"& input, & button\": {\n      verticalAlign: \"middle\",\n      marginRight: \".5em\"\n    },\n    \"& label\": {\n      fontSize: \"80%\"\n    }\n  },\n\n  searchMatch: {\n    background: \"#ffa\"\n  },\n\n  \"searchMatch.selected\": {\n    background: \"#fca\"\n  }\n})\n"],"names":[],"mappings":"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"}